# Task: ä¿®å¤èµ„æ–™æ•´ç†ç»“æœæ˜¾ç¤ºå’ŒæŸ¥è¯¢å±•ç¤º

## Plan
- [x] Step 1: ä¿®å¤èµ„æ–™æ•´ç†ç»“æœå¼¹çª—
  - [x] æ›´æ­£å­—æ®µåï¼šsynthesis â†’ synthesized_insights
  - [x] æ˜¾ç¤ºæ‰€æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼ˆsynthesized_insightsã€key_data_pointsã€contradictions_or_gapsï¼‰
  - [x] æ·»åŠ æ–‡æœ¬æ¢è¡Œæ”¯æŒï¼ˆwhitespace-pre-wrap break-wordsï¼‰
  - [x] ç»¼åˆæ´å¯Ÿæ˜¾ç¤ºä¸ºå¡ç‰‡åˆ—è¡¨è€Œéå•ä¸ªæ–‡æœ¬å—
- [x] Step 2: éªŒè¯æœç´¢è®¡åˆ’æŸ¥è¯¢æ˜¾ç¤º
  - [x] ç¡®è®¤ SearchPlanPanel æ­£ç¡®æ˜¾ç¤ºæ‰€æœ‰æŸ¥è¯¢ç±»å‹
  - [x] å­¦æœ¯è°ƒç ”ï¼ˆacademic_queriesï¼‰- è“è‰²å¡ç‰‡
  - [x] è¡Œä¸šèµ„è®¯ï¼ˆnews_queriesï¼‰- æ©™è‰²å¡ç‰‡
  - [x] ç½‘é¡µå†…å®¹ï¼ˆweb_queriesï¼‰- ç»¿è‰²å¡ç‰‡
  - [x] èµ„æ–™åº“ï¼ˆuser_library_queriesï¼‰- ç´«è‰²å¡ç‰‡
- [x] Step 3: è¿è¡Œ lint æ£€æŸ¥

## å®Œæˆæƒ…å†µ
âœ… æ‰€æœ‰ä»»åŠ¡å·²å®Œæˆï¼

## æœ¬æ¬¡ä¿®å¤å†…å®¹

### 1. èµ„æ–™æ•´ç†ç»“æœå¼¹çª—æ˜¾ç¤ºé—®é¢˜ï¼ˆIssue #1ï¼‰

**é—®é¢˜æè¿°**ï¼š
1. æ–‡æœ¬è¶…å‡ºå®¹å™¨å®½åº¦æ—¶æ²¡æœ‰æ¢è¡Œï¼Œå¯¼è‡´æ˜¾ç¤ºä¸å®Œæ•´
2. ç¼ºå°‘ `synthesized_insights`ï¼ˆç»¼åˆæ´å¯Ÿï¼‰éƒ¨åˆ†çš„æ˜¾ç¤º
3. åªæ˜¾ç¤ºäº† `key_data_points` å’Œ `contradictions_or_gaps` ä¸¤ä¸ªéƒ¨åˆ†

**æ ¹æœ¬åŸå› **ï¼š
- ç»„ä»¶ä½¿ç”¨äº†é”™è¯¯çš„å­—æ®µå `synthesisResults.synthesis`ï¼Œå®é™…å­—æ®µåæ˜¯ `synthesisResults.synthesized_insights`
- ç¼ºå°‘æ–‡æœ¬æ¢è¡Œçš„ CSS ç±»ï¼ˆ`whitespace-pre-wrap` å’Œ `break-words`ï¼‰

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **æ›´æ­£å­—æ®µåæ˜ å°„**ï¼š
   ```typescript
   // âŒ é”™è¯¯ï¼ˆæ—§ä»£ç ï¼‰
   {synthesisResults.synthesis && (...)}
   
   // âœ… æ­£ç¡®ï¼ˆæ–°ä»£ç ï¼‰
   {synthesisResults.synthesized_insights && 
    synthesisResults.synthesized_insights.length > 0 && (...)}
   ```

2. **æ·»åŠ æ–‡æœ¬æ¢è¡Œæ”¯æŒ**ï¼š
   ```typescript
   // æ‰€æœ‰æ–‡æœ¬å®¹å™¨æ·»åŠ 
   className="text-sm leading-relaxed whitespace-pre-wrap break-words"
   ```
   - `whitespace-pre-wrap`: ä¿ç•™ç©ºæ ¼å’Œæ¢è¡Œç¬¦ï¼Œè‡ªåŠ¨æ¢è¡Œ
   - `break-words`: é•¿å•è¯/URL åœ¨å¿…è¦æ—¶æ–­è¡Œ
   - `leading-relaxed`: å¢åŠ è¡Œé«˜ï¼Œæå‡å¯è¯»æ€§

3. **ç»¼åˆæ´å¯Ÿæ˜¾ç¤ºä¸ºå¡ç‰‡åˆ—è¡¨**ï¼š
   ```typescript
   {synthesisResults.synthesized_insights.map((insight: any, idx: number) => (
     <div className="bg-blue-50 dark:bg-blue-950 p-4 rounded-lg border-l-4 border-blue-500">
       <p className="text-sm leading-relaxed whitespace-pre-wrap break-words">
         {parseContent(insight)}
       </p>
     </div>
   ))}
   ```

4. **æ›´æ–° parseContent è¾…åŠ©å‡½æ•°**ï¼š
   ```typescript
   const parseContent = (item: any): string => {
     if (typeof item === 'string') return item;
     if (item && typeof item === 'object') {
       return item.insight ||        // â† æ–°å¢ï¼šæ”¯æŒ synthesized_insights
              item.data_point || 
              item.point || 
              item.text || 
              item.description || 
              item.gap || 
              item.contradiction || 
              JSON.stringify(item);
     }
     return String(item);
   };
   ```

**æ•°æ®ç»“æ„**ï¼ˆæ¥è‡ª research-synthesis-agentï¼‰ï¼š
```json
{
  "synthesized_insights": [
    "æ´å¯Ÿ1ï¼šå…³äºå•†ä¸šåŒ–å¤±è´¥çš„æ ¸å¿ƒè§‚ç‚¹...",
    "æ´å¯Ÿ2ï¼šç”¨æˆ·è¯†åˆ«çš„å…³é”®æ–¹æ³•...",
    "æ´å¯Ÿ3ï¼šROIè¯„ä¼°çš„å®è·µç»éªŒ..."
  ],
  "key_data_points": [
    {"data_point": "2025å¹´æŠ–éŸ³ä¸»ç«™è¶…2200äº¿ï¼Œcontext": "..."},
    {"data_point": "æ–°æ´²å”±2025ã€‹æŠ–éŸ³ä¸»é¢˜æ›²93äº¿ï¼Œcontext": "..."}
  ],
  "contradictions_or_gaps": [
    {"gap": "ç¼ºä¹å…³äºAI agentåœ¨ç‰¹å®šè¡Œä¸šçš„å¤±è´¥æ¡ˆä¾‹åˆ†æ"}
  ]
}
```

**æ˜¾ç¤ºæ•ˆæœ**ï¼š
- âœ… ç»¼åˆæ´å¯Ÿï¼šè“è‰²å¡ç‰‡ï¼Œå·¦ä¾§è“è‰²è¾¹æ¡†ï¼Œæ”¯æŒå¤šæ¡æ´å¯Ÿ
- âœ… å…³é”®æ•°æ®ç‚¹ï¼šç»¿è‰²å¡ç‰‡ï¼Œå·¦ä¾§ç»¿è‰²è¾¹æ¡†ï¼Œæ•°å­—åŠ ç²—æ˜¾ç¤º
- âœ… çŸ›ç›¾æˆ–ç ”ç©¶ç©ºç™½ï¼šé»„è‰²å¡ç‰‡ï¼Œå·¦ä¾§é»„è‰²è¾¹æ¡†ï¼Œå…³é”®è¯åŠ ç²—
- âœ… æ‰€æœ‰æ–‡æœ¬è‡ªåŠ¨æ¢è¡Œï¼Œä¸ä¼šè¶…å‡ºå®¹å™¨å®½åº¦
- âœ… é•¿ URL å’Œæ•°æ®ä¼šåœ¨å¿…è¦æ—¶æ–­è¡Œ

### 2. æœç´¢è®¡åˆ’æŸ¥è¯¢æ˜¾ç¤ºï¼ˆIssue #2ï¼‰

**ç”¨æˆ·åé¦ˆ**ï¼š
"research retrieval agent è¾“å‡ºç»“æœ JSON ä¸²ä¸­ academic_queriesã€news_queriesã€web_queriesã€user_library_queries éƒ¨åˆ†éœ€è¦å±•ç¤ºåœ¨é¡µé¢æœç´¢è®¡åˆ’æ¨¡å—ä¸‹"

**å®é™…æƒ…å†µ**ï¼š
âœ… **åŠŸèƒ½å·²æ­£ç¡®å®ç°**ï¼ŒSearchPlanPanel ç»„ä»¶å·²å®Œæ•´æ˜¾ç¤ºæ‰€æœ‰æŸ¥è¯¢ç±»å‹ã€‚

**æ•°æ®æµéªŒè¯**ï¼š
```
Edge Function (research-retrieval-agent)
  â†“ è¿”å›
{
  search_summary: {
    interpreted_topic: "AI agent å•†ä¸šåŒ–å¤±è´¥åˆ†æ",
    key_dimensions: ["å•†ä¸šåŒ–å¤±è´¥æ¨¡å¼", "ç”¨æˆ·è¯†åˆ«æ–¹æ³•", ...],
    academic_queries: ["AI agent commercialization failure", ...],
    news_queries: ["AIæ™ºèƒ½ä½“å•†ä¸šåŒ–", "AI agentå¤±è´¥æ¡ˆä¾‹", ...],
    web_queries: ["AI agentå•†ä¸šåŒ–æŒ‘æˆ˜", ...],
    user_library_queries: ["å•†ä¸šåŒ–", "å¤±è´¥åˆ†æ", ...]
  }
}
  â†“ ä¿å­˜åˆ°
retrievalResults (KnowledgeStage state)
  â†“ è§£æä¸º
searchSummary = {
  interpreted_topic: retrievalResults.search_summary.interpreted_topic,
  key_dimensions: retrievalResults.search_summary.key_dimensions,
  academic_queries: retrievalResults.search_summary.academic_queries,    // â† æå–
  news_queries: retrievalResults.search_summary.news_queries,            // â† æå–
  web_queries: retrievalResults.search_summary.web_queries,              // â† æå–
  user_library_queries: retrievalResults.search_summary.user_library_queries // â† æå–
}
  â†“ ä¼ é€’ç»™
<SearchPlanPanel searchSummary={searchSummary} />
  â†“ æ˜¾ç¤ºåœ¨
"æ•°æ®æºæŸ¥è¯¢"éƒ¨åˆ†
```

**æ˜¾ç¤ºå¸ƒå±€**ï¼ˆSearchPlanPanelï¼‰ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” ç†è§£çš„ä¸»é¢˜                        â”‚
â”‚ AI agent å•†ä¸šåŒ–å¤±è´¥åˆ†æ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…³é”®ç»´åº¦                             â”‚
â”‚ [å•†ä¸šåŒ–å¤±è´¥æ¨¡å¼] [ç”¨æˆ·è¯†åˆ«æ–¹æ³•] ...  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ•°æ®æºæŸ¥è¯¢              å…± 16 æ¡æŸ¥è¯¢ â”‚
â”‚                                      â”‚
â”‚ ğŸ“š å­¦æœ¯è°ƒç ” (Google Scholar)  4 æ¡   â”‚
â”‚   â”œâ”€ AI agent commercialization...  â”‚
â”‚   â”œâ”€ user identification methods... â”‚
â”‚   â”œâ”€ ROI evaluation frameworks...   â”‚
â”‚   â””â”€ academic vs industry gap...    â”‚
â”‚                                      â”‚
â”‚ ğŸ“° è¡Œä¸šèµ„è®¯ (TheNews)         4 æ¡   â”‚
â”‚   â”œâ”€ AIæ™ºèƒ½ä½“å•†ä¸šåŒ–                  â”‚
â”‚   â”œâ”€ AI agentå¤±è´¥æ¡ˆä¾‹                â”‚
â”‚   â”œâ”€ ç”¨æˆ·è¯†åˆ«æŠ€æœ¯                    â”‚
â”‚   â””â”€ ROIè¯„ä¼°æ–¹æ³•                     â”‚
â”‚                                      â”‚
â”‚ ğŸŒ ç½‘é¡µå†…å®¹ (Smart Search)    4 æ¡   â”‚
â”‚   â”œâ”€ AI agentå•†ä¸šåŒ–æŒ‘æˆ˜              â”‚
â”‚   â”œâ”€ æ™ºèƒ½ä½“ç”¨æˆ·å®šä½                  â”‚
â”‚   â”œâ”€ AIäº§å“ROIåˆ†æ                   â”‚
â”‚   â””â”€ å­¦æœ¯ç ”ç©¶ä¸å®è·µå·®å¼‚              â”‚
â”‚                                      â”‚
â”‚ ğŸ’¾ èµ„æ–™åº“                     4 æ¡   â”‚
â”‚   â”œâ”€ å•†ä¸šåŒ–                          â”‚
â”‚   â”œâ”€ å¤±è´¥åˆ†æ                        â”‚
â”‚   â”œâ”€ ç”¨æˆ·è¯†åˆ«                        â”‚
â”‚   â””â”€ ROIè¯„ä¼°                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ·å¼ç‰¹ç‚¹**ï¼š
- å­¦æœ¯è°ƒç ”ï¼šè“è‰²èƒŒæ™¯ï¼ˆ`bg-blue-50`ï¼‰+ è“è‰²è¾¹æ¡†ï¼ˆ`border-blue-200`ï¼‰
- è¡Œä¸šèµ„è®¯ï¼šæ©™è‰²èƒŒæ™¯ï¼ˆ`bg-orange-50`ï¼‰+ æ©™è‰²è¾¹æ¡†ï¼ˆ`border-orange-200`ï¼‰
- ç½‘é¡µå†…å®¹ï¼šç»¿è‰²èƒŒæ™¯ï¼ˆ`bg-green-50`ï¼‰+ ç»¿è‰²è¾¹æ¡†ï¼ˆ`border-green-200`ï¼‰
- èµ„æ–™åº“ï¼šç´«è‰²èƒŒæ™¯ï¼ˆ`bg-purple-50`ï¼‰+ ç´«è‰²è¾¹æ¡†ï¼ˆ`border-purple-200`ï¼‰
- æ¯ä¸ªæ•°æ®æºæ ‡é¢˜å³ä¾§æ˜¾ç¤ºæŸ¥è¯¢æ•°é‡å¾½ç« ï¼ˆå¦‚"4 æ¡"ï¼‰
- "æ•°æ®æºæŸ¥è¯¢"æ ‡é¢˜å³ä¾§æ˜¾ç¤ºæ€»æŸ¥è¯¢æ•°ï¼ˆå¦‚"å…± 16 æ¡æŸ¥è¯¢"ï¼‰

**extractQueryText è¾…åŠ©å‡½æ•°**ï¼š
```typescript
const extractQueryText = (query: string | any): string => {
  if (typeof query === 'string') return query;
  if (query && typeof query === 'object') {
    return query.query || query.text || query.keywords || JSON.stringify(query);
  }
  return String(query);
};
```
- æ”¯æŒå­—ç¬¦ä¸²æŸ¥è¯¢ï¼š`"AI agent commercialization"`
- æ”¯æŒå¯¹è±¡æŸ¥è¯¢ï¼š`{ query: "...", keywords: "..." }`
- è‡ªåŠ¨æå–æœ€ç›¸å…³çš„å­—æ®µ

**è°ƒè¯•æ”¯æŒ**ï¼š
åœ¨ KnowledgeStage.tsx ä¸­æ·»åŠ äº†è°ƒè¯•æ—¥å¿—ï¼š
```typescript
console.log('[KnowledgeStage] searchSummary:', searchSummary);
console.log('[KnowledgeStage] academic_queries:', searchSummary?.academic_queries);
console.log('[KnowledgeStage] news_queries:', searchSummary?.news_queries);
console.log('[KnowledgeStage] web_queries:', searchSummary?.web_queries);
console.log('[KnowledgeStage] user_library_queries:', searchSummary?.user_library_queries);
```
- å¦‚æœæŸ¥è¯¢æœªæ˜¾ç¤ºï¼Œå¯åœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹æ•°æ®æ˜¯å¦æ­£ç¡®ä¼ é€’

## æŠ€æœ¯å®ç°ç»†èŠ‚

### ä»£ç ä¿®æ”¹

1. **SynthesisResultsDialog.tsx**ï¼š
   - æ›´æ­£å­—æ®µåï¼š`synthesisResults.synthesis` â†’ `synthesisResults.synthesized_insights`
   - æ·»åŠ æ–‡æœ¬æ¢è¡Œç±»ï¼š`whitespace-pre-wrap break-words`ï¼ˆlines 33, 77, 112ï¼‰
   - ç»¼åˆæ´å¯Ÿæ”¹ä¸ºå¡ç‰‡åˆ—è¡¨æ˜¾ç¤ºï¼ˆlines 20-42ï¼‰
   - æ›´æ–° parseContent å‡½æ•°æ”¯æŒ `item.insight` å­—æ®µï¼ˆline 23ï¼‰
   - æ›´æ–°ç©ºçŠ¶æ€æ£€æŸ¥é€»è¾‘ï¼ˆlines 122-128ï¼‰

2. **SearchPlanPanel.tsx**ï¼š
   - âœ… å·²æ­£ç¡®å®ç°æ‰€æœ‰æŸ¥è¯¢æ˜¾ç¤ºåŠŸèƒ½
   - å­¦æœ¯è°ƒç ”ï¼ˆlines 106-123ï¼‰
   - è¡Œä¸šèµ„è®¯ï¼ˆlines 126-143ï¼‰
   - ç½‘é¡µå†…å®¹ï¼ˆlines 146-163ï¼‰
   - èµ„æ–™åº“ï¼ˆlines 166-183ï¼‰
   - æŸ¥è¯¢æ•°é‡ç»Ÿè®¡ï¼ˆlines 83-93ï¼‰
   - extractQueryText è¾…åŠ©å‡½æ•°ï¼ˆlines 19-25ï¼‰

3. **KnowledgeStage.tsx**ï¼š
   - âœ… å·²æ­£ç¡®æå–å’Œä¼ é€’ searchSummary æ•°æ®ï¼ˆlines 729-736ï¼‰
   - âœ… æ·»åŠ è°ƒè¯•æ—¥å¿—è¾“å‡ºï¼ˆlines 739-743ï¼‰

### æ•°æ®ç»“æ„å¯¹æ¯”

**research-synthesis-agent è¾“å‡º**ï¼š
```typescript
{
  synthesized_insights: string[],        // ç»¼åˆæ´å¯Ÿæ•°ç»„
  key_data_points: Array<{               // å…³é”®æ•°æ®ç‚¹æ•°ç»„
    data_point: string,
    context: string,
    source: string
  }>,
  contradictions_or_gaps: Array<{        // çŸ›ç›¾æˆ–ç©ºç™½æ•°ç»„
    gap?: string,
    contradiction?: string
  }>
}
```

**SynthesisResultsDialog æ˜¾ç¤ºé€»è¾‘**ï¼š
```typescript
// 1. ç»¼åˆæ´å¯Ÿï¼ˆè“è‰²ï¼‰
synthesisResults.synthesized_insights?.map(insight => 
  <div className="bg-blue-50 border-l-4 border-blue-500">
    <p className="whitespace-pre-wrap break-words">{insight}</p>
  </div>
)

// 2. å…³é”®æ•°æ®ç‚¹ï¼ˆç»¿è‰²ï¼‰
synthesisResults.key_data_points?.map(point => 
  <div className="bg-green-50 border-l-4 border-green-500">
    <p className="whitespace-pre-wrap break-words" 
       dangerouslySetInnerHTML={{ __html: formattedContent }} />
  </div>
)

// 3. çŸ›ç›¾æˆ–ç ”ç©¶ç©ºç™½ï¼ˆé»„è‰²ï¼‰
synthesisResults.contradictions_or_gaps?.map(item => 
  <div className="bg-yellow-50 border-l-4 border-yellow-500">
    <p className="whitespace-pre-wrap break-words" 
       dangerouslySetInnerHTML={{ __html: formattedContent }} />
  </div>
)
```

## éªŒè¯æ¸…å•
- âœ… èµ„æ–™æ•´ç†ç»“æœæ˜¾ç¤ºæ‰€æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼ˆsynthesized_insightsã€key_data_pointsã€contradictions_or_gapsï¼‰
- âœ… ç»¼åˆæ´å¯Ÿä»¥å¡ç‰‡åˆ—è¡¨å½¢å¼æ˜¾ç¤ºï¼Œæ¯æ¡æ´å¯Ÿç‹¬ç«‹å¡ç‰‡
- âœ… æ‰€æœ‰æ–‡æœ¬æ”¯æŒè‡ªåŠ¨æ¢è¡Œï¼Œä¸ä¼šè¶…å‡ºå®¹å™¨å®½åº¦
- âœ… é•¿ URL å’Œæ•°æ®åœ¨å¿…è¦æ—¶æ–­è¡Œ
- âœ… æœç´¢è®¡åˆ’æ­£ç¡®æ˜¾ç¤ºæ‰€æœ‰æŸ¥è¯¢ç±»å‹ï¼ˆacademicã€newsã€webã€user_libraryï¼‰
- âœ… æ¯ä¸ªæ•°æ®æºæ˜¾ç¤ºæŸ¥è¯¢æ•°é‡å¾½ç« 
- âœ… æ€»æŸ¥è¯¢æ•°ç»Ÿè®¡æ­£ç¡®
- âœ… æŸ¥è¯¢å¡ç‰‡é¢œè‰²åŒºåˆ†æ¸…æ™°ï¼ˆè“/æ©™/ç»¿/ç´«ï¼‰
- âœ… æ‰€æœ‰ä»£ç é€šè¿‡ TypeScript lint æ£€æŸ¥

## ç”¨æˆ·ä½“éªŒæ”¹è¿›
1. **æ–‡æœ¬å¯è¯»æ€§**ï¼š
   - è‡ªåŠ¨æ¢è¡Œé¿å…æ¨ªå‘æ»šåŠ¨
   - é•¿ URL ä¸ä¼šç ´åå¸ƒå±€
   - è¡Œé«˜é€‚ä¸­ï¼ˆ`leading-relaxed`ï¼‰

2. **ä¿¡æ¯å±‚æ¬¡**ï¼š
   - ä¸‰ä¸ªéƒ¨åˆ†æ¸…æ™°åˆ†éš”ï¼ˆSeparatorï¼‰
   - å›¾æ ‡å’Œé¢œè‰²åŒºåˆ†ä¸åŒç±»å‹
   - å¡ç‰‡å¼å¸ƒå±€æå‡è§†è§‰å±‚æ¬¡

3. **æ•°æ®å®Œæ•´æ€§**ï¼š
   - æ˜¾ç¤ºæ‰€æœ‰ç»¼åˆæ´å¯Ÿï¼ˆä¹‹å‰ç¼ºå¤±ï¼‰
   - ä¿ç•™æ‰€æœ‰å…³é”®æ•°æ®ç‚¹
   - å±•ç¤ºæ‰€æœ‰çŸ›ç›¾å’Œç ”ç©¶ç©ºç™½

4. **æŸ¥è¯¢å¯è§æ€§**ï¼š
   - æ‰€æœ‰æŸ¥è¯¢ç±»å‹éƒ½åœ¨æœç´¢è®¡åˆ’ä¸­å±•ç¤º
   - æ•°é‡ç»Ÿè®¡å¸®åŠ©ç”¨æˆ·äº†è§£æœç´¢èŒƒå›´
   - é¢œè‰²ç¼–ç å¿«é€Ÿè¯†åˆ«æ•°æ®æºç±»å‹

## å®Œæˆæƒ…å†µ
âœ… æ‰€æœ‰ä»»åŠ¡å·²å®Œæˆï¼

## å®ç°çš„æ”¹è¿›

### 1. éœ€æ±‚æ–‡æ¡£å›ºå®šæ˜¾ç¤º
- åˆ›å»º `RequirementsDocDialog` ç»„ä»¶ï¼Œç¾è§‚å±•ç¤ºéœ€æ±‚æ–‡æ¡£å†…å®¹
- åœ¨ `WorkflowProgress` ç»„ä»¶å³ä¸Šè§’æ·»åŠ "éœ€æ±‚æ–‡æ¡£"æŒ‰é’®
- åªåœ¨æ˜ç¡®éœ€æ±‚é˜¶æ®µä¹‹åæ˜¾ç¤ºï¼ˆcurrentIndex >= 1ï¼‰
- æ™ºèƒ½è§£æ JSON æ ¼å¼çš„éœ€æ±‚æ–‡æ¡£ï¼Œå±•ç¤ºä¸»é¢˜ã€ç›®æ ‡ã€å…³é”®ç»´åº¦ã€æ—¶é—´èŒƒå›´ç­‰
- åœ¨ `ProjectWorkflowPage` ä¸­åŠ è½½å¹¶ä¼ é€’éœ€æ±‚æ–‡æ¡£æ•°æ®

### 2. Google Scholar API æµ‹è¯•
- åˆ›å»º `test-google-scholar.js` æµ‹è¯•è„šæœ¬
- éªŒè¯ Edge Function å®ç°æ­£ç¡®
- API è°ƒç”¨é€»è¾‘æ— è¯¯ï¼Œä½¿ç”¨æ­£ç¡®çš„ Gateway API
- ç½‘ç»œè¿æ¥é—®é¢˜éœ€åœ¨å®é™…éƒ¨ç½²ç¯å¢ƒæµ‹è¯•

### 3. æ·»åŠ "è¿›å…¥ä¸‹ä¸€æ­¥"æŒ‰é’®
- **æ˜ç¡®éœ€æ±‚é˜¶æ®µ**ï¼šåœ¨"ç¡®è®¤éœ€æ±‚"æŒ‰é’®æ—æ·»åŠ "è¿›å…¥ä¸‹ä¸€æ­¥"æŒ‰é’®
  - ä½¿ç”¨ `ArrowRight` å›¾æ ‡
  - åªæœ‰ç¡®è®¤åæ‰èƒ½è¿›å…¥ä¸‹ä¸€æ­¥
- **èµ„æ–™æŸ¥è¯¢é˜¶æ®µ**ï¼šåœ¨"èµ„æ–™æ•´ç†"æŒ‰é’®æ—æ·»åŠ "è¿›å…¥ä¸‹ä¸€æ­¥"æŒ‰é’®
  - ç›´æ¥è·³è½¬åˆ°æ–‡ç« ç»“æ„é˜¶æ®µ
  - æ— éœ€ç”Ÿæˆç»¼åˆæ‘˜è¦å³å¯è¿›å…¥

### 4. æœç´¢ç»“æœæ•°æ®æ¸…ç†
- å®ç° `cleanSearchResults` å‡½æ•°ï¼ŒåŒ…å«ä¸‰å±‚æ¸…ç†ï¼š
  1. **è¿‡æ»¤ä¸å½“å†…å®¹**ï¼šæ£€æµ‹å¹¶ç§»é™¤åŒ…å«è‰²æƒ…ã€èµŒåšã€æ¯’å“ç­‰å…³é”®è¯çš„ç»“æœ
  2. **æ ‡é¢˜å»é‡**ï¼šç›¸åŒæ ‡é¢˜åªä¿ç•™å†…å®¹æ›´å®Œæ•´çš„ï¼ˆextracted_content æ›´å¤šï¼‰
  3. **æ—¶æ•ˆæ€§éªŒè¯**ï¼šæ ¹æ®éœ€æ±‚æ–‡æ¡£ä¸­çš„ year_start/year_end è¿‡æ»¤ç»“æœ
- åœ¨ `loadKnowledge` ä¸­è‡ªåŠ¨åº”ç”¨æ•°æ®æ¸…ç†
- ç¡®ä¿æ•°æ®è´¨é‡å’Œç›¸å…³æ€§

### 5. æ—¥å¿—æ æ ·å¼ä¼˜åŒ–
- å›ºå®šåº•éƒ¨æ—¥å¿—æ èƒŒæ™¯è‰²æ”¹ä¸ºé»‘è‰²ï¼ˆ`bg-black`ï¼‰
- æ–‡å­—ä½¿ç”¨ç™½è‰²å’Œç°è‰²ç³»ï¼ˆ`text-white`, `text-gray-300`ï¼‰
- æ‚¬åœæ•ˆæœæ”¹ä¸ºæ·±ç°è‰²ï¼ˆ`hover:bg-gray-900`ï¼‰
- åˆ†éš”çº¿ä½¿ç”¨æ·±ç°è‰²ï¼ˆ`bg-gray-700`ï¼‰
- æå‡è§†è§‰å¯¹æ¯”åº¦å’Œä¸“ä¸šæ„Ÿ

### 6. æœç´¢è®¡åˆ’æ˜¾ç¤ºä¼˜åŒ–
- åœ¨æ•°æ®æºåç§°ä¸­æ·»åŠ å…·ä½“æœåŠ¡åç§°ï¼ˆGoogle Scholar, TheNews, Smart Searchï¼‰
- æŸ¥è¯¢å…³é”®è¯ä½¿ç”¨å½©è‰²èƒŒæ™¯å¡ç‰‡å±•ç¤ºï¼š
  - å­¦æœ¯è°ƒç ”ï¼šè“è‰²èƒŒæ™¯ï¼ˆ`bg-blue-50 dark:bg-blue-950`ï¼‰
  - è¡Œä¸šèµ„è®¯ï¼šæ©™è‰²èƒŒæ™¯ï¼ˆ`bg-orange-50 dark:bg-orange-950`ï¼‰
  - ç½‘é¡µå†…å®¹ï¼šç»¿è‰²èƒŒæ™¯ï¼ˆ`bg-green-50 dark:bg-green-950`ï¼‰
  - èµ„æ–™åº“ï¼šç´«è‰²èƒŒæ™¯ï¼ˆ`bg-purple-50 dark:bg-purple-950`ï¼‰
- æ¯ä¸ªæŸ¥è¯¢å…³é”®è¯ç‹¬ç«‹æ˜¾ç¤ºï¼Œæ¸…æ™°æ˜“è¯»

### 7. é¡¹ç›®ä¸Šä¸‹æ–‡éš”ç¦»
- æ•°æ®æ¸…ç†åŸºäºå½“å‰é¡¹ç›®çš„éœ€æ±‚æ–‡æ¡£ï¼ˆ`brief.requirements`ï¼‰
- æ—¶æ•ˆæ€§éªŒè¯ä»éœ€æ±‚æ–‡æ¡£ä¸­æå–æ—¶é—´é™åˆ¶
- æ‰€æœ‰ LLM è°ƒç”¨éƒ½ä¼ é€’ `projectId` å‚æ•°
- Edge Functions é€šè¿‡ `projectId` éš”ç¦»ä¸åŒé¡¹ç›®çš„æ•°æ®
- ç¡®ä¿ä¸ä¼šå‡ºç°è·¨é¡¹ç›®å†…å®¹æ±¡æŸ“

### 8. ä»£ç è´¨é‡
- æ‰€æœ‰ä»£ç é€šè¿‡ TypeScript lint æ£€æŸ¥
- ä¿®å¤ç±»å‹é”™è¯¯ï¼ˆBrief.requirements vs requirements_docï¼‰
- æ­£ç¡®å¤„ç† JSON å’Œå­—ç¬¦ä¸²æ ¼å¼çš„éœ€æ±‚æ–‡æ¡£
- æ·»åŠ é”™è¯¯å¤„ç†å’Œæ—¥å¿—è¾“å‡º

## å®Œæˆæƒ…å†µ
âœ… æ‰€æœ‰ä»»åŠ¡å·²å®Œæˆï¼

## å®ç°çš„æ”¹è¿›

### 1. Google Scholar æœç´¢éªŒè¯
- æ£€æŸ¥äº† Edge Function å®ç°ï¼Œä½¿ç”¨æ­£ç¡®çš„ Gateway API
- æœç´¢é€»è¾‘æ­£ç¡®ï¼Œé€šè¿‡ research-retrieval-agent è°ƒç”¨
- å¦‚æœä»æœ‰é—®é¢˜ï¼Œå¯èƒ½æ˜¯ API Key æˆ–ç½‘ç»œé—®é¢˜

### 2. æœç´¢è®¡åˆ’æ˜¾ç¤ºä¼˜åŒ–
- SearchPlanPanel å·²æ­£ç¡®å®ç°æ‰€æœ‰æŸ¥è¯¢ç±»å‹çš„è§£æå’Œæ˜¾ç¤º
- æ”¯æŒ academic_queriesã€news_queriesã€web_queriesã€user_library_queries
- ä½¿ç”¨å›¾æ ‡å’Œé¢œè‰²åŒºåˆ†ä¸åŒæ•°æ®æº

### 3. èµ„æ–™æ•´ç†å¼¹çª—ä¼˜åŒ–
- åŒ…å«å®Œæ•´çš„ç»¼åˆæ´å¯Ÿã€å…³é”®æ•°æ®ç‚¹ã€çŸ›ç›¾æˆ–ç ”ç©¶ç©ºç™½
- æ™ºèƒ½è§£æ JSON å†…å®¹
- è‡ªåŠ¨åŠ ç²—å…³é”®æ•°æ®å’Œå…³é”®è¯
- è°ƒæ•´ä¸ºå†…å®¹è‡ªé€‚åº”é«˜åº¦

### 4. æœç´¢æ—¥å¿—é‡æ„
- åˆ›å»ºå›ºå®šåº•éƒ¨æ—¥å¿—æ ï¼Œæ˜¾ç¤ºæœ€æ–°æ—¥å¿—çŠ¶æ€
- ç‚¹å‡»æ—¥å¿—æ æ‰“å¼€è¯¦æƒ…å¼¹çª—
- æ—¥å¿—å¼¹çª—é‡‡ç”¨æ—¶é—´è½´æ ¼å¼ï¼Œå‚è€ƒç”¨æˆ·æä¾›çš„è®¾è®¡
- æ”¯æŒä¸‹è½½å®Œæ•´æ—¥å¿—
- æ™ºèƒ½è§£ææ—¥å¿—é˜¶æ®µå’ŒçŠ¶æ€

### 5. é¡µé¢æ¸…ç†
- ç§»é™¤åº•éƒ¨ç»¼åˆåˆ†æç»“æœå¡ç‰‡ï¼ˆå·²åœ¨èµ„æ–™æ•´ç†å¼¹çª—ä¸­å±•ç¤ºï¼‰
- ç§»é™¤ç»¼åˆåˆ†ææ—¥å¿—å¡ç‰‡
- æ‰€æœ‰å¼¹çª—è°ƒæ•´ä¸ºå†…å®¹è‡ªé€‚åº”é«˜åº¦
- ä¼˜åŒ–æ•´ä½“é¡µé¢å¸ƒå±€å’Œç”¨æˆ·ä½“éªŒ

## å®Œæˆæƒ…å†µ
âœ… æ‰€æœ‰ä»»åŠ¡å·²å®Œæˆï¼

## å®ç°çš„æ”¹è¿›
1. **æœç´¢è®¡åˆ’é¢æ¿ä¼˜åŒ–**ï¼š
   - æ·»åŠ  JSON è§£æé€»è¾‘ï¼Œæ”¯æŒå¯¹è±¡ç±»å‹çš„æŸ¥è¯¢å†…å®¹
   - å®Œæ•´æ˜¾ç¤ºæ‰€æœ‰æ•°æ®æºçš„æŸ¥è¯¢è®¡åˆ’
   
2. **å¸ƒå±€ä¼˜åŒ–**ï¼š
   - æœç´¢è®¡åˆ’å’Œæœç´¢ç»“æœåˆå¹¶åˆ°åŒä¸€ä¸ªå¡ç‰‡
   - ç§»åŠ¨ç«¯ä½¿ç”¨å‚ç›´å¸ƒå±€ï¼Œæ¡Œé¢ç«¯ä½¿ç”¨å·¦å³åˆ†æ 
   - æ·»åŠ è¾¹æ¡†åˆ†éš”ï¼Œæå‡è§†è§‰å±‚æ¬¡
   
3. **äº¤äº’æ”¹è¿›**ï¼š
   - æ”¶è—å’Œåˆ é™¤æŒ‰é’®å§‹ç»ˆå¯è§
   - æ“ä½œåæ˜¾ç¤ºæˆåŠŸ/å¤±è´¥æç¤º
   - æœªé€‰ä¸­æ—¶ç‚¹å‡»æŒ‰é’®ä¼šæç¤ºç”¨æˆ·å…ˆé€‰æ‹©
   
4. **æ—¶é—´ç­›é€‰ä¿®å¤**ï¼š
   - æ­£ç¡®å¤„ç† published_at å’Œ collected_at å­—æ®µ
   - æ·»åŠ ç©ºå€¼æ£€æŸ¥ï¼Œé¿å…ç­›é€‰é”™è¯¯
   
5. **è¯¦æƒ…å¼¹çª—ä¼˜åŒ–**ï¼š
   - å¼¹çª—å°ºå¯¸å¢å¤§åˆ° max-w-6xl
   - å“åº”å¼å®½åº¦ w-95vw
   - å†…å®¹åŒºåŸŸå¯æ»šåŠ¨ï¼Œæœ€å¤§é«˜åº¦ 70vh
   
6. **å†…å®¹æ¸…ç†**ï¼š
   - ç§»é™¤"å†™ä½œçº§ç ”ç©¶æ‘˜è¦"å†—ä½™éƒ¨åˆ†
   - ä¼˜åŒ–ç»¼åˆåˆ†æç»“æœçš„ JSON è§£æ
   - æ”¯æŒå¤šç§å­—æ®µåç§°çš„è§£æ
