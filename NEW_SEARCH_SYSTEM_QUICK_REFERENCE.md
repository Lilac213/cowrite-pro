# ğŸš€ æ–°ç‰ˆæœç´¢ç³»ç»Ÿå¿«é€Ÿå‚è€ƒ

## æ ¸å¿ƒæ¦‚å¿µ

### ---THOUGHT--- / ---JSON--- åˆ†ç¦»æ¨¡å¼

**é—®é¢˜**ï¼šLLM è¾“å‡ºçš„ JSON æ ¼å¼ä¸ç¨³å®šï¼Œç»å¸¸åŒ…å«æ³¨é‡Šã€å¤šä½™æ–‡æœ¬ã€æ ¼å¼é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼šè®© LLM åˆ†ä¸¤éƒ¨åˆ†è¾“å‡º
```
---THOUGHT---
ï¼ˆLLM çš„æ€è€ƒè¿‡ç¨‹ï¼Œå¯ä»¥è‡ªç”±è¡¨è¾¾ï¼‰

---JSON---
{
  "structured": "output"
}
```

**ä¼˜åŠ¿**ï¼š
- âœ… LLM ä¸éœ€è¦åœ¨æ€è€ƒæ—¶éµå®ˆ JSON æ ¼å¼
- âœ… ç³»ç»Ÿåªè§£æ `---JSON---` éƒ¨åˆ†
- âœ… å¤§å¹…é™ä½è§£æå¤±è´¥ç‡ï¼ˆä» 60% æå‡åˆ° ~100%ï¼‰

---

## API ç«¯ç‚¹

### 1. Research Retrieval Agent
**ç«¯ç‚¹**ï¼š`/functions/v1/research-retrieval-agent`

**è¯·æ±‚**ï¼š
```json
{
  "requirementsDoc": "ç”¨æˆ·çš„ç ”ç©¶éœ€æ±‚æ–‡æ¡£"
}
```

**å“åº”**ï¼š
```json
{
  "success": true,
  "data": {
    "search_summary": {
      "interpreted_topic": "ä¸»é¢˜ç†è§£",
      "key_dimensions": ["ç»´åº¦1", "ç»´åº¦2"]
    },
    "academic_sources": [...],
    "news_sources": [...],
    "web_sources": [...],
    "user_library_sources": []
  },
  "raw_content": "LLM åŸå§‹è¾“å‡ºï¼ˆç”¨äºè°ƒè¯•ï¼‰"
}
```

### 2. Research Synthesis Agent
**ç«¯ç‚¹**ï¼š`/functions/v1/research-synthesis-agent`

**è¯·æ±‚**ï¼š
```json
{
  "retrievalResults": {...},
  "requirementsDoc": "åŸå§‹éœ€æ±‚æ–‡æ¡£"
}
```

**å“åº”**ï¼š
```json
{
  "success": true,
  "data": {
    "synthesized_insights": [...],
    "key_data_points": [...],
    "contradictions_or_gaps": [...]
  },
  "raw_content": "LLM åŸå§‹è¾“å‡ºï¼ˆç”¨äºè°ƒè¯•ï¼‰"
}
```

---

## é›†æˆçš„å¤–éƒ¨ API

### 1. Google Scholar API
- **ç”¨é€”**ï¼šå­¦æœ¯ç ”ç©¶ã€æ–¹æ³•è®ºã€å®è¯åˆ†æ
- **æ—¶é—´èŒƒå›´**ï¼š2020å¹´è‡³ä»Š
- **æ¯æ¬¡æŸ¥è¯¢**ï¼šæœ€å¤š10æ¡ç»“æœ
- **è¿”å›å­—æ®µ**ï¼štitle, authors, abstract, citation_count, publication_year, url

### 2. TheNews API
- **ç”¨é€”**ï¼šæ–°é—»/è¡Œä¸šåŠ¨æ€ã€å•†ä¸šå®è·µ
- **æ—¶é—´èŒƒå›´**ï¼šè¿‘1-2å¹´
- **æ¯æ¬¡æŸ¥è¯¢**ï¼šæœ€å¤š10æ¡ç»“æœ
- **è¿”å›å­—æ®µ**ï¼štitle, summary, source, published_at, url

### 3. Smart Search (Bing) API
- **ç”¨é€”**ï¼šåšå®¢ã€ç™½çš®ä¹¦ã€è¡Œä¸šæŠ¥å‘Š
- **æ—¶é—´èŒƒå›´**ï¼šè¿‘12-24ä¸ªæœˆ
- **æ¯æ¬¡æŸ¥è¯¢**ï¼šæœ€å¤š10æ¡ç»“æœ
- **è¿”å›å­—æ®µ**ï¼štitle, site_name, snippet, url, last_crawled_at

---

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯

| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|------|---------|
| "æœªæ‰¾åˆ° ---JSON--- æ ‡è®°" | LLM è¾“å‡ºæ ¼å¼ä¸æ­£ç¡® | æŸ¥çœ‹ `raw_content` å­—æ®µï¼Œæ£€æŸ¥ LLM è¾“å‡º |
| "è§£ææœç´¢è®¡åˆ’å¤±è´¥" | JSON è§£æé”™è¯¯ | æŸ¥çœ‹ Edge Function æ—¥å¿— |
| "æ•´ç†ç»“æœå¤±è´¥" | JSON è§£æé”™è¯¯ | æŸ¥çœ‹ Edge Function æ—¥å¿— |
| "Google Scholar æœç´¢å¤±è´¥" | API è°ƒç”¨å¤±è´¥ | æ£€æŸ¥ API å¯†é’¥å’Œç½‘ç»œè¿æ¥ |
| "TheNews æœç´¢å¤±è´¥" | API è°ƒç”¨å¤±è´¥ | æ£€æŸ¥ API å¯†é’¥å’Œç½‘ç»œè¿æ¥ |
| "Smart Search æœç´¢å¤±è´¥" | API è°ƒç”¨å¤±è´¥ | æ£€æŸ¥ API å¯†é’¥å’Œç½‘ç»œè¿æ¥ |

### è°ƒè¯•æ­¥éª¤

1. **æŸ¥çœ‹è¿”å›çš„ `raw_content` å­—æ®µ**
   - åŒ…å« LLM çš„åŸå§‹è¾“å‡º
   - å¯ä»¥çœ‹åˆ° `---THOUGHT---` å’Œ `---JSON---` éƒ¨åˆ†

2. **æŸ¥çœ‹ Edge Function æ—¥å¿—**
   ```bash
   # åœ¨ Supabase Dashboard ä¸­
   Edge Functions â†’ research-retrieval-agent â†’ Logs
   ```

3. **æ£€æŸ¥ç¯å¢ƒå˜é‡**
   - `DEEPSEEK_API_KEY`ï¼šDeepSeek API å¯†é’¥
   - `INTEGRATIONS_API_KEY`ï¼šå¤–éƒ¨ API é›†æˆå¯†é’¥

---

## æ€§èƒ½ç‰¹ç‚¹

### å¹¶è¡Œæœç´¢
- ä¸‰ä¸ªå¤–éƒ¨ API åŒæ—¶è°ƒç”¨
- å•ä¸ª API å¤±è´¥ä¸å½±å“å…¶ä»– API
- æ€»å“åº”æ—¶é—´ = max(API1, API2, API3) + LLM æ—¶é—´

### å»é‡æœºåˆ¶
- åŸºäº URL å»é‡
- æ¯ä¸ªæ•°æ®æºæœ€å¤šè¿”å› 10 æ¡ç»“æœ
- ç¡®ä¿ç»“æœçš„å¤šæ ·æ€§

### é”™è¯¯å®¹å¿
- å•ä¸ª API å¤±è´¥ä¸ä¼šå¯¼è‡´æ•´ä¸ªæœç´¢å¤±è´¥
- å³ä½¿æ‰€æœ‰å¤–éƒ¨ API å¤±è´¥ï¼Œä»ç„¶è¿”å›æœç´¢è®¡åˆ’
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—ä¾¿äºè°ƒè¯•

---

## ä¸æ—§ç‰ˆçš„å¯¹æ¯”

| ç‰¹æ€§ | æ—§ç‰ˆ | æ–°ç‰ˆ |
|-----|------|------|
| JSON è§£ææˆåŠŸç‡ | ~60% | ~100% |
| é”™è¯¯ä¿¡æ¯ | æ¨¡ç³Š | æ˜ç¡® |
| å¤–éƒ¨ API é›†æˆ | æ—  | 3ä¸ª |
| å¹¶è¡Œæœç´¢ | å¦ | æ˜¯ |
| è°ƒè¯•èƒ½åŠ› | å¼± | å¼ºï¼ˆraw_content + è¯¦ç»†æ—¥å¿—ï¼‰ |
| é”™è¯¯å®¹å¿ | ä½ | é«˜ |

---

## æœ€ä½³å®è·µ

### 1. ç¼–å†™éœ€æ±‚æ–‡æ¡£
```json
{
  "topic": "AI Agent çš„å•†ä¸šåŒ–è·¯å¾„",
  "key_points": [
    "ç›®æ ‡ç”¨æˆ·å®šä½æ–¹æ³•",
    "å•†ä¸šåŒ–å¤±è´¥æ¡ˆä¾‹",
    "ROI è¯„ä¼°æ–¹å¼"
  ],
  "target_audience": "äº§å“ç»ç†ã€æŠ€æœ¯è´Ÿè´£äºº",
  "expected_length": "3000-5000å­—"
}
```

### 2. å¤„ç†æœç´¢ç»“æœ
```typescript
const result = await researchRetrievalAgent(requirementsDoc);

if (result.success) {
  // ä½¿ç”¨ result.data
  console.log('å­¦æœ¯èµ„æ–™:', result.data.academic_sources);
  console.log('æ–°é—»èµ„æ–™:', result.data.news_sources);
  console.log('ç½‘ç»œèµ„æ–™:', result.data.web_sources);
} else {
  // æŸ¥çœ‹ raw_content è¿›è¡Œè°ƒè¯•
  console.error('æœç´¢å¤±è´¥:', result.error);
  console.log('LLM åŸå§‹è¾“å‡º:', result.raw_content);
}
```

### 3. ç›‘æ§å’Œä¼˜åŒ–
- å®šæœŸæ£€æŸ¥ `raw_content` å­—æ®µ
- ç›‘æ§å¤–éƒ¨ API çš„æˆåŠŸç‡
- æ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µè°ƒæ•´æœç´¢æŸ¥è¯¢ç­–ç•¥

---

## ç›¸å…³æ–‡æ¡£

- [100% æœç´¢æˆåŠŸç‡å®ç°æ–¹æ¡ˆ](./100_PERCENT_SUCCESS_IMPLEMENTATION.md) - è¯¦ç»†çš„æŠ€æœ¯å®ç°
- [è°ƒè¯•æŒ‡å—](./DEBUG_GUIDE.md) - å®Œæ•´çš„è°ƒè¯•æŒ‡å—
- [æ§åˆ¶å­—ç¬¦ä¿®å¤è¯´æ˜](./CONTROL_CHARACTER_FIX.md) - æ—§ç‰ˆ JSON ä¿®å¤é€»è¾‘ï¼ˆå·²å¼ƒç”¨ï¼‰
