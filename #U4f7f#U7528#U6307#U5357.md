# CoWrite 使用指南

## 首次使用必读

### 1. 配置 API 密钥

在使用 CoWrite 的 AI 功能之前，您需要先配置 LLM API 密钥。

#### 步骤：

1. 点击侧边栏的"设置"
2. 在"LLM 配置"部分：
   - 选择 LLM 提供商（OpenAI 或 Anthropic）
   - 输入您的 API 密钥
3. （可选）在"搜索配置"部分配置搜索 API
4. 点击"保存设置"

#### 获取 API 密钥：

**OpenAI:**
- 访问：https://platform.openai.com/api-keys
- 注册/登录账户
- 创建新的 API 密钥
- 复制密钥并粘贴到 CoWrite 设置中

**Anthropic (Claude):**
- 访问：https://console.anthropic.com/
- 注册/登录账户
- 创建新的 API 密钥
- 复制密钥并粘贴到 CoWrite 设置中

### 2. 常见错误及解决方案

#### 错误：Edge Function returned a non-2xx status code

**原因：**
- 未配置 LLM API 密钥
- API 密钥无效或已过期
- API 配额已用完

**解决方案：**
1. 进入"设置"页面
2. 检查是否已配置 LLM 提供商和 API 密钥
3. 确认 API 密钥正确无误
4. 检查 API 账户是否有足够的配额

#### 错误：请先在设置中配置 LLM API 密钥

**解决方案：**
按照上述"配置 API 密钥"步骤进行配置。

#### 错误：API 调用失败

**可能原因：**
- API 密钥错误
- 网络连接问题
- API 服务暂时不可用

**解决方案：**
1. 检查 API 密钥是否正确
2. 检查网络连接
3. 稍后重试

---

## 功能使用指南

### 项目工作流

#### 1. 创建项目
- 在项目列表页点击"新建项目"
- 输入项目标题
- 点击"创建"

#### 2. 明确需求
- 输入文章选题/写作目标
- （可选）填写格式模板和输出格式
- 点击"生成需求文档"
- **注意：** 首次使用需要先配置 API 密钥
- 查看 AI 生成的需求文档
- 确认无误后点击"确认需求"

#### 3. 资料查询
- AI 自动搜索相关信息
- 查看搜索结果卡片
- 勾选需要的信息
- 点击"确认选择"

#### 4. 段落摘要
- AI 生成段落摘要
- 可以编辑、删除或添加段落
- 调整段落顺序
- 确认结构后进入下一步

#### 5. 个人素材（可选）
- 添加个人经历、观点或案例
- 上传参考文章
- 这些素材会在文章生成时使用

#### 6. 文章生成
- AI 根据需求、知识库、段落摘要和个人素材生成完整文章
- 使用协作文档编辑器直接修改
- AI 修改有标记，不会覆盖用户内容

#### 7. 三遍审校
**第一遍：内容审校**
- 检查事实准确性
- 检查逻辑清晰性
- 检查结构合理性

**第二遍：风格审校**
- 删除套话
- 拆解 AI 句式
- 替换书面词汇
- 改成口语化

**第三遍：细节打磨**
- 检查句子长度
- 检查段落长度
- 检查标点使用
- 优化节奏变化

#### 8. 完成
- 查看最终文章
- 导出为所需格式

---

### 素材库使用

#### 创建素材
1. 进入"素材库"页面
2. 点击"新建素材"
3. 选择类型（个人经历/观点/案例）
4. 填写标题和内容
5. 点击"创建"

#### 管理素材
- **添加标签：** 点击素材卡片上的"标签"按钮
- **关联项目：** 点击"关联项目"按钮，选择要关联的项目
- **筛选素材：** 使用标签筛选和状态筛选
- **搜索素材：** 使用搜索框进行全文搜索

#### AI 整理
1. 点击右上角"AI 整理"按钮
2. AI 会自动：
   - 为素材打标签
   - 识别相似素材
   - 推荐可组合成文章的素材集合
   - 推荐关联项目

---

### 参考文章库使用

#### 添加参考文章
1. 进入"参考文章库"页面
2. 点击"新建参考文章"
3. 填写标题、内容、来源类型和链接
4. 点击"创建"

#### AI 分析
1. 点击文章卡片上的"AI 整理"按钮
2. AI 会自动分析：
   - 核心观点（3-5个）
   - 文章结构（引言/主体/结论）
   - 可借鉴段落
   - 推荐适合的项目

#### 使用分析结果
- 点击"查看分析"查看详细结果
- 每个观点和段落都可以一键加入素材库
- 参考文章结构进行写作

---

### 模板管理使用

#### AI 辅助生成模板
1. 进入"模板管理"页面
2. 点击"新建模板"
3. 选择"AI 辅助生成"标签
4. 用自然语言描述格式要求，例如：
   ```
   本科毕业论文，理工科
   封面包含：学校、学院、姓名、学号
   正文小四宋体，1.5 倍行距
   一级标题三号黑体居中
   ```
5. 点击"AI 生成模板规则"
6. 查看生成的规则
7. 填写模板名称
8. 点击"创建模板"

#### 手动创建模板
1. 选择"手动创建"标签
2. 填写模板名称和描述
3. 输入模板内容
4. 点击"创建模板"

#### 使用模板
- 模板在终稿输出时生效
- 选择输出模板
- 系统自动套用格式
- 自动生成目录
- 输出 Word / PDF

---

### AI 降重工具使用

1. 进入"AI 降重工具"页面
2. 在左侧输入框粘贴需要降重的文本
3. 或点击上传文件导入
4. 点击"降 AI 率"按钮
5. 在右侧查看降重后的文章
6. 可以选择模板导出

---

## 最佳实践

### 1. 项目管理
- 为每个写作任务创建独立项目
- 使用清晰的项目标题
- 定期整理已完成的项目

### 2. 素材积累
- 及时记录灵感和想法
- 为素材添加详细标签
- 定期使用 AI 整理功能
- 将相关素材关联到项目

### 3. 参考文章
- 添加文章后立即进行 AI 分析
- 将有价值的观点加入素材库
- 学习优秀文章的结构
- 利用可借鉴段落提升写作质量

### 4. 模板使用
- 为常用格式创建模板
- 使用 AI 生成复杂格式模板
- 定期更新和优化模板
- 模板仅在终稿输出时应用

### 5. API 使用
- 合理使用 AI 功能，避免频繁调用
- 定期检查 API 配额使用情况
- 保护好 API 密钥，不要分享给他人

---

## 数据安全

- 所有数据存储在 Supabase 数据库
- 支持用户级别的数据隔离
- API 密钥加密存储
- 定期备份重要数据

---

## 技术支持

如遇到问题，请检查：
1. API 密钥是否正确配置
2. 网络连接是否正常
3. API 配额是否充足
4. 浏览器控制台是否有错误信息

---

## 更新日志

### v1.1.0 (2026-02-02)
- ✨ 新增 AI 辅助模板生成功能
- ✨ 增强型个人素材库（标签、状态、项目关联）
- ✨ 智能参考文章库（AI 分析、观点提取）
- ✨ AI 整理助手
- 🐛 改进错误提示信息
- 🐛 优化 API 错误处理

### v1.0.0 (2026-01-30)
- 🎉 首次发布
- ✨ 项目工作流管理
- ✨ AI 辅助写作
- ✨ 三遍审校系统
- ✨ 素材库和参考文章库
- ✨ 模板管理
- ✨ AI 降重工具
